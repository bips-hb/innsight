<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Custom Model Definition • innsight</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Custom Model Definition">
<meta property="og:description" content="innsight">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">innsight</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Custom_Model_Definition.html">Custom Model Definition</a>
    </li>
    <li>
      <a href="../articles/Introduction.html">Introduction to innsight</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bips-hb/innsight/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Custom_Model_Definition_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Custom Model Definition</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bips-hb/innsight/blob/master/vignettes/Custom_Model_Definition.Rmd"><code>vignettes/Custom_Model_Definition.Rmd</code></a></small>
      <div class="hidden name"><code>Custom_Model_Definition.Rmd</code></div>

    </div>

    
    
<p>Besides models from the packages <code>keras</code>, <code>torch</code> and <code>neuralnet</code> it is also possible to pass a self defined model in form of a named list to the converter class. This enables the interpretation of networks from other packages with all available methods provided by the <code>innsight</code> package.</p>
<div id="general-information" class="section level2">
<h2 class="hasAnchor">
<a href="#general-information" class="anchor"></a>General Information</h2>
<p>If you want to create a custom model, your list (e.g. <code>model &lt;- list()</code>) needs at least the keys <code>model$input_dim</code> and <code>model$layers</code>. However, there are other optional keys that can be used to name the input features and output nodes or to test the model for correctness. In summary:</p>
<ul>
<li><p><strong><code>$input_dim</code></strong><br>
An integer vector with the model input dimension without the batch axis, e.g. for a dense layer with 5 input features use <code>c(5)</code> or for a 1D-convolutional layer with signal length 50 and 4 channels use <code>c(4,50)</code>.</p></li>
<li><p><strong><code>$input_names</code></strong> (optional)<br>
A list with the names for each input dimension excluding the batch axis, e.g. for a dense layer with 3 input features use <code>list(c("X1", "X2", "X3"))</code> or for a 1D-convolutional layer with signal length 5 and 2 channels use <code>list(c("C1", "C2"), c("L1","L2","L3","L4","L5"))</code>. By default (<code>NULL</code>), the names are generated.</p></li>
<li><p><strong><code>$output_dim</code></strong> (optional)<br>
An integer vector with the model output dimension analogous to <code>$input_dim</code>. This value does not need to be specified and will be calculated otherwise. However, if it is set, the calculated value will be compared with it to avoid errors during converting the model.</p></li>
<li><p><strong><code>$output_names</code></strong> (optional)<br>
A list with the names for each output dimension analogous to <code>$input_names</code>. By default (<code>NULL</code>), the names are generated.</p></li>
<li><p><strong><code>$layers</code></strong><br>
(see next section)</p></li>
</ul>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">model</span><span class="op">$</span><span class="va">input_dim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>
<span class="va">model</span><span class="op">$</span><span class="va">input_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Feat1"</span>, <span class="st">"Feat2"</span>, <span class="st">"Feat3"</span>, <span class="st">"Feat4"</span><span class="op">)</span><span class="op">)</span> <span class="co"># optional</span>
<span class="va">model</span><span class="op">$</span><span class="va">output_dim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="co"># optional</span>
<span class="va">model</span><span class="op">$</span><span class="va">output_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Out1"</span>, <span class="st">"Out2"</span><span class="op">)</span><span class="op">)</span> <span class="co"># optional</span>
<span class="va">model</span><span class="op">$</span><span class="va">layers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># see next section </span></code></pre></div>
</div>
<div id="adding-layers" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-layers" class="anchor"></a>Adding Layers</h2>
<p>The component <code>$layers</code> is again a list that describes each individual layer of the model as another list in correct order. Additionally, depending on the layer type, other keys are required to create a well-defined model. Currently, the following layers are accepted:</p>
<div id="dense-layer" class="section level3">
<h3 class="hasAnchor">
<a href="#dense-layer" class="anchor"></a>Dense Layer</h3>
<ul>
<li><p><strong><code>$type</code></strong>: <code>'Dense'</code></p></li>
<li><p><strong><code>$weight</code></strong>: The weight matrix of the dense layer with shape (<code>dim_out</code>, <code>dim_in</code>).</p></li>
<li><p><strong><code>$bias</code></strong>: The bias vector of the dense layer with length <code>dim_out</code>.</p></li>
<li><p><strong><code>activation_name</code></strong>: The name of the activation function for this dense layer, e.g. <code>'relu'</code>, <code>'tanh'</code> or <code>'softmax'</code>.</p></li>
<li><p><strong><code>dim_in</code></strong> (optional): The input dimension of this layer excluding the batch axis e.g. for 3 input features use <code>c(3)</code>. This value is not necessary, but helpful to check the format of the weight matrix and the overall correctness of the converted model.</p></li>
<li><p><strong><code>dim_out</code></strong> (optional): The output dimension of this layer excluding the batch axis. This value is not necessary, but helpful to check the format of the weight matrix and the overall correctness of the converted model.</p></li>
</ul>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Define dense layer</span>
<span class="va">dense_layer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  type <span class="op">=</span> <span class="st">'Dense'</span>,
  weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">5</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span>,
  bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>,
  activation_name <span class="op">=</span> <span class="st">'tanh'</span>,
  dim_in <span class="op">=</span> <span class="fl">5</span>, <span class="co"># optional</span>
  dim_out <span class="op">=</span> <span class="fl">2</span> <span class="co"># optional</span>
<span class="op">)</span>

<span class="co"># Adding layer to model</span>
<span class="va">model</span><span class="op">$</span><span class="va">layers</span><span class="op">$</span><span class="va">custom_dense</span> <span class="op">&lt;-</span> <span class="va">dense_layer</span></code></pre></div>
</div>
<div id="convolutional-layers" class="section level3">
<h3 class="hasAnchor">
<a href="#convolutional-layers" class="anchor"></a>Convolutional Layers</h3>
<ul>
<li><p><strong><code>$type</code></strong>: <code>'Conv1D'</code> or <code>'Conv2D'</code></p></li>
<li><p><strong><code>$weight</code></strong>: The weight array of the convolutional layer with shape (<code>out_channels</code>, <code>in_channels</code>, <code>kernel_length</code>) for 1D or (<code>out_channels</code>, <code>in_channels</code>, <code>kernel_height</code>, <code>kernel_width</code>) for 2D.</p></li>
<li><p><strong><code>$bias</code></strong>: The bias vector of the layer with length <code>out_channels</code>.</p></li>
<li><p><strong><code>$activation_name</code></strong>: The name of the activation function for this layer, e.g. <code>'relu'</code>, <code>'tanh'</code> or <code>'softmax'</code>.</p></li>
<li><p><strong><code>$dim_in</code></strong> (optional): The input dimension of this layer according to the format (<code>in_channels</code>, <code>in_length</code>) for 1D or (<code>in_channels</code>, <code>in_height</code>, <code>in_width</code>) for 2D. This value is not necessary, but helpful to check the format of the weight array and the overall correctness of the converted model.</p></li>
<li><p><strong><code>$dim_out</code></strong> (optional): The output dimension of this layer according to the format (<code>out_channels</code>, <code>out_length</code>) for 1D or (<code>out_channels</code>, <code>out_height</code>, <code>out_width</code>) for 2D. This value is not necessary, but helpful to check the format of the weight array and the overall correctness of the converted model.</p></li>
<li><p><strong><code>$stride</code></strong> (optional): The stride of the convolution (single integer for 1D and tuple of two integers for 2D). If this value is not specified, the default values (1D: <code>1</code> and 2D: <code>c(1,1)</code>) are used.</p></li>
<li><p><strong><code>$padding</code></strong> (optional): Zero-padding added to the sides of the input before convolution. For 1D-convolution a tuple of the form (<code>pad_left</code>, <code>pad_right</code>) and for 2D-convolution (<code>pad_left</code>, <code>pad_right</code>, <code>pad_top</code>, <code>pad_bottom</code>) is required. If this value is not specified, the default values (1D: <code>c(0,0)</code> and 2D: <code>c(0,0,0,0)</code>) are used.</p></li>
<li><p><strong><code>$dilation</code></strong> (optional): Spacing between kernel elements (single integer for 1D and tuple of two integers for 2D). If this value is not specified, the default values (1D: <code>1</code> and 2D: <code>c(1,1)</code>) are used.</p></li>
</ul>
<p><strong>Examples:</strong><br>
Create 1D-convolutional layer with: <code>'in_channels' = 3</code>, <code>'out_channels' = 8</code>, <code>'kernel_length' = 2</code>, <code>'activation_name' = 'tanh'</code> and default values for <code>'padding'</code>, <code>'stride'</code> and <code>'dilation'</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">conv_1D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
      type <span class="op">=</span> <span class="st">"Conv1D"</span>,
      weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">8</span><span class="op">*</span><span class="fl">3</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">8</span>,<span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>, 
      bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">8</span><span class="op">)</span>,
      activation_name <span class="op">=</span> <span class="st">"tanh"</span>,
      dim_in <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">10</span><span class="op">)</span>, <span class="co"># optional</span>
      dim_out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">9</span><span class="op">)</span> <span class="co"># optional</span>
    <span class="op">)</span>
<span class="co"># Adding layer to model</span>
<span class="va">model</span><span class="op">$</span><span class="va">layers</span><span class="op">$</span><span class="va">custom_conv1D</span> <span class="op">&lt;-</span> <span class="va">conv_1D</span></code></pre></div>
<p>Create 2D-convolutional layer with: <code>'in_channels' = 3</code>, <code>'out_channels' = 8</code>, <code>'kernel_height' = 2</code>, <code>'kernel_width' = 4</code>, <code>'activation_name' = 'relu'</code>, <code>'padding' = c(1,1,0,0)</code> and <code>'dilation' = c(1,2)</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">conv_2D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
      type <span class="op">=</span> <span class="st">"Conv2D"</span>,
      weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">8</span><span class="op">*</span><span class="fl">3</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="fl">4</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">8</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>,
      bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">8</span><span class="op">)</span>,
      padding <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,
      dilation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,
      activation_name <span class="op">=</span> <span class="st">"relu"</span>,
      dim_in <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span> <span class="co"># optional</span>
    <span class="op">)</span>
<span class="co"># Adding layer to model</span>
<span class="va">model</span><span class="op">$</span><span class="va">layers</span><span class="op">$</span><span class="va">custom_conv2D</span> <span class="op">&lt;-</span> <span class="va">conv_2D</span></code></pre></div>
</div>
<div id="pooling-layers" class="section level3">
<h3 class="hasAnchor">
<a href="#pooling-layers" class="anchor"></a>Pooling Layers</h3>
<ul>
<li><p><strong><code>$type</code></strong>: <code>'MaxPooling1D'</code>, <code>'MaxPooling2D'</code>, <code>'AveragePooling1D'</code> or <code>'AveragePooling2D'</code></p></li>
<li><p><strong><code>$kernel_size</code></strong>: The size of the pooling window as an integer value for 1D-pooling and an tuple of two integers for 2D-pooling.</p></li>
<li><p><strong><code>$strides</code></strong> (optional): The stride of the pooling window (single integer for 1D and tuple of two integers for 2D). If this value is not specified (<code>NULL</code>), the value of <code>kernel_size</code> will be used.</p></li>
<li><p><strong><code>dim_in</code></strong> (optional): The input dimension of this layer according to the format (<code>in_channels</code>, <code>in_length</code>) for 1D or (<code>in_channels</code>, <code>in_height</code>, <code>in_width</code>) for 2D. This value is not necessary, but helpful to check overall correctness of the converted model.</p></li>
<li><p><strong><code>$dim_out</code></strong> (optional): The output dimension of this layer according to the format (<code>out_channels</code>, <code>out_length</code>) for 1D or (<code>out_channels</code>, <code>out_height</code>, <code>out_width</code>) for 2D. This value is not necessary, but helpful to check overall correctness of the converted model.</p></li>
</ul>
<p><strong>Example:</strong> Create 2D average pooling with kernel size <code>'c(2,2)'</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">avg_pool2D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  type <span class="op">=</span> <span class="st">"AveragePooling2D"</span>,
  kernel_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>
  <span class="op">)</span>
<span class="co"># Adding layer to model</span>
<span class="va">model</span><span class="op">$</span><span class="va">layers</span><span class="op">$</span><span class="va">custom_avgpool2D</span> <span class="op">&lt;-</span> <span class="va">avg_pool2D</span></code></pre></div>
</div>
<div id="flatten-layer" class="section level3">
<h3 class="hasAnchor">
<a href="#flatten-layer" class="anchor"></a>Flatten Layer</h3>
<ul>
<li><p><strong><code>$type</code></strong>: <code>'Flatten'</code></p></li>
<li><p><strong><code>$dim_in</code></strong> (optional): The input dimension of this layer without the batch dimension.</p></li>
<li><p><strong><code>$dim_out</code></strong> (optional): The output dimension of this layer without the batch dimension.</p></li>
</ul>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">flatten</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  type <span class="op">=</span> <span class="st">"Flatten"</span>
  <span class="op">)</span>
<span class="co"># Adding layer to model</span>
<span class="va">model</span><span class="op">$</span><span class="va">layers</span><span class="op">$</span><span class="va">custom_flatten</span> <span class="op">&lt;-</span> <span class="va">flatten</span></code></pre></div>
</div>
</div>
<div id="full-examples" class="section level2">
<h2 class="hasAnchor">
<a href="#full-examples" class="anchor"></a>Full Examples</h2>
<div id="dense-network" class="section level3">
<h3 class="hasAnchor">
<a href="#dense-network" class="anchor"></a>Dense Network</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://bips-hb.github.io/innsight/">innsight</a></span><span class="op">)</span>

<span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">model</span><span class="op">$</span><span class="va">input_dim</span> <span class="op">&lt;-</span> <span class="fl">5</span>
<span class="va">model</span><span class="op">$</span><span class="va">input_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Feat1"</span>, <span class="st">"Feat2"</span>, <span class="st">"Feat3"</span>, <span class="st">"Feat4"</span>, <span class="st">"Feat5"</span><span class="op">)</span><span class="op">)</span>
<span class="va">model</span><span class="op">$</span><span class="va">output_dim</span> <span class="op">&lt;-</span> <span class="fl">2</span>
<span class="va">model</span><span class="op">$</span><span class="va">output_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Cat"</span>, <span class="st">"no-Cat"</span><span class="op">)</span><span class="op">)</span>
<span class="va">model</span><span class="op">$</span><span class="va">layers</span><span class="op">$</span><span class="va">Layer_1</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    type <span class="op">=</span> <span class="st">"Dense"</span>,
    weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">5</span> <span class="op">*</span> <span class="fl">20</span><span class="op">)</span>, <span class="fl">20</span>, <span class="fl">5</span><span class="op">)</span>,
    bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>,
    activation_name <span class="op">=</span> <span class="st">"tanh"</span>,
    dim_in <span class="op">=</span> <span class="fl">5L</span>,
    dim_out <span class="op">=</span> <span class="fl">20L</span>
  <span class="op">)</span>
<span class="va">model</span><span class="op">$</span><span class="va">layers</span><span class="op">$</span><span class="va">Layer_2</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    type <span class="op">=</span> <span class="st">"Dense"</span>,
    weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">20</span><span class="op">)</span>,
    bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>,
    activation_name <span class="op">=</span> <span class="st">"softmax"</span>,
    dim_in <span class="op">=</span> <span class="fl">20L</span>,
    dim_out <span class="op">=</span> <span class="fl">2L</span>
  <span class="op">)</span>

<span class="co"># Convert the model</span>
<span class="va">converter</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Converter.html">Converter</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></code></pre></div>
</div>
<div id="cnn-for-images" class="section level3">
<h3 class="hasAnchor">
<a href="#cnn-for-images" class="anchor"></a>CNN for Images</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://bips-hb.github.io/innsight/">innsight</a></span><span class="op">)</span>

<span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">model</span><span class="op">$</span><span class="va">input_dim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">30</span>, <span class="fl">30</span><span class="op">)</span>
<span class="va">model</span><span class="op">$</span><span class="va">output_dim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>

<span class="va">model</span><span class="op">$</span><span class="va">layers</span><span class="op">$</span><span class="va">Layer_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  type <span class="op">=</span> <span class="st">"Conv2D"</span>,
  weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">*</span><span class="fl">3</span><span class="op">*</span><span class="fl">5</span><span class="op">*</span><span class="fl">5</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>,
  bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>,
  activation_name <span class="op">=</span> <span class="st">"relu"</span>
<span class="op">)</span>
<span class="va">model</span><span class="op">$</span><span class="va">layers</span><span class="op">$</span><span class="va">Layer_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  type <span class="op">=</span> <span class="st">'AveragePooling2D'</span>,
  kernel_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,
  dim_in <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">26</span>, <span class="fl">26</span><span class="op">)</span> <span class="co"># optional</span>
<span class="op">)</span>
<span class="va">model</span><span class="op">$</span><span class="va">layers</span><span class="op">$</span><span class="va">Layer_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  type <span class="op">=</span> <span class="st">'Conv2D'</span>,
  weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">8</span><span class="op">*</span><span class="fl">10</span><span class="op">*</span><span class="fl">4</span><span class="op">*</span><span class="fl">4</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">8</span>,<span class="fl">10</span>,<span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>,
  bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">8</span><span class="op">)</span>,
  activation_name <span class="op">=</span> <span class="st">"relu"</span>,
  padding <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>,
  dim_out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">16</span>, <span class="fl">14</span><span class="op">)</span> <span class="co"># optional</span>
<span class="op">)</span>
<span class="va">model</span><span class="op">$</span><span class="va">layers</span><span class="op">$</span><span class="va">Layer_4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  type <span class="op">=</span> <span class="st">"AveragePooling2D"</span>,
  kernel_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,
  strides <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">model</span><span class="op">$</span><span class="va">layers</span><span class="op">$</span><span class="va">Layer_5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  type <span class="op">=</span> <span class="st">"Flatten"</span>,
  dim_out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">320</span><span class="op">)</span> <span class="co"># optional</span>
<span class="op">)</span>
<span class="va">model</span><span class="op">$</span><span class="va">layers</span><span class="op">$</span><span class="va">Layer_6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  type <span class="op">=</span> <span class="st">"Dense"</span>,
  weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">320</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">320</span><span class="op">)</span><span class="op">)</span>,
  bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>,
  activation_name <span class="op">=</span> <span class="st">"softmax"</span>
<span class="op">)</span>

<span class="co"># Convert the model</span>
<span class="va">converter</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Converter.html">Converter</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Niklas Koenen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
