<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Get the Insights of your Neural Network • innsight</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Get the Insights of your Neural Network">
<meta property="og:description" content="Interpretability methods to analyze the behavior and
    individual predictions of modern neural networks. Implemented methods
    are: Connection Weights described by Olden et al. (2004)
    &lt;doi:10.1016/j.ecolmodel.2004.03.013&gt;, Layer-wise Relevance
    Propagation (LRP) described by Bach et al. (2015)
    &lt;doi:10.1371/journal.pone.0130140&gt;, Deep Learning Important Features
    (DeepLIFT) described by Shrikumar et al.  (2017) &lt;arXiv:1704.02685&gt;
    and gradient-based methods like SmoothGrad described by Smilkov et
    al. (2017) &lt;arXiv:1706.03825&gt;, Gradient x Input described by
    Baehrens et al. (2009) &lt;arXiv:0912.1128&gt; or Vanilla Gradient.">
<meta property="og:image" content="https://bips-hb.github.io/innsight/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">innsight</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="articles/innsight.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/Example_1_iris.html">Example 1: Iris Dataset with `torch`</a>
    </li>
    <li>
      <a href="articles/Example_2_penguin.html">Example 2: Penguin Dataset with `torch` and `luz`</a>
    </li>
    <li>
      <a href="articles/Example_3_imagenet.html">Example 3: ImageNet with `keras`</a>
    </li>
    <li>
      <a href="articles/detailed_overview.html">In-depth Explanation</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bips-hb/innsight/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="innsight---get-the-insights-of-your-neural-network">
<code>innsight</code> - Get the Insights of your Neural Network<a class="anchor" aria-label="anchor" href="#innsight---get-the-insights-of-your-neural-network"></a>
</h1></div>
<p><a href="https://bips-hb.github.io/innsight/"><img src="reference/figures/logo.png" align="right" width="200"></a></p>
<!-- badges: start -->

<div class="section level2">
<h2 id="table-of-contents">Table of Contents<a class="anchor" aria-label="anchor" href="#table-of-contents"></a>
</h2>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#usage">Usage</a></li>
<li><a href="#examples">Examples</a></li>
<li><a href="#contributing-and-future-work">Contributing and Future Work</a></li>
<li><a href="#funding">Funding</a></li>
</ul>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><strong>innsight</strong> is an R package that interprets the behavior and explains individual predictions of modern neural networks. Many methods for explaining individual predictions already exist, but hardly any of them are implemented or available in R. Most of these so-called <em>feature attribution</em> methods are only implemented in Python and thus difficult to access or use for the R community. In this sense, the package <strong>innsight</strong> provides a common interface for various methods for the interpretability of neural networks and can therefore be considered as an R analogue to <a href="https://github.com/albermax/innvestigate" class="external-link">iNNvestigate</a> or <a href="https://captum.ai/" class="external-link">Captum</a> for Python.</p>
<p>This package implements several model-specific interpretability (feature attribution) methods based on neural networks in R, e.g.,</p>
<ul>
<li>Layer-wise Relevance Propagation (<a href="https://doi.org/10.1371/journal.pone.0130140" class="external-link">LRP</a>)
<ul>
<li>Including propagation rules: <span class="math inline"><em>ε</em></span>-rule and <span class="math inline"><em>α</em></span>-<span class="math inline"><em>β</em></span>-rule</li>
</ul>
</li>
<li>Deep Learning Important Features (<a href="https://arxiv.org/abs/1704.02685" class="external-link">DeepLift</a>)
<ul>
<li>Including propagation rules for non-linearities: rescale rule and reveal-cancel rule</li>
</ul>
</li>
<li>Gradient-based methods:
<ul>
<li>Vanilla Gradient, including <a href="https://www.jmlr.org/papers/v11/baehrens10a.html" class="external-link">Gradient x Input</a>
</li>
<li>Smoothed gradients (<a href="https://arxiv.org/abs/1706.03825" class="external-link">SmoothGrad</a>), including SmoothGrad x Input</li>
</ul>
</li>
<li>Connection Weights</li>
</ul>
<p>Example results for these methods on ImageNet with pretrained network Vgg19 ( see <a href="https://bips-hb.github.io/innsight/articles/Example_3_imagenet.html">Example 3: ImageNet with <strong>keras</strong></a> for details): <img src="https://github.com/bips-hb/innsight/blob/master/man/images/Vgg19_result.png?raw=true" alt="vgg16"></p>
<p>The package <strong>innsight</strong> aims to be as flexible as possible and independent of a specific deep learning package in which the passed network has been learned. Basically, a neural network of the libraries <a href="https://torch.mlverse.org/" class="external-link"><strong>torch</strong></a>, <a href="https://tensorflow.rstudio.com/" class="external-link"><strong>keras</strong></a> and <a href="https://CRAN.R-project.org/package=neuralnet" class="external-link"><strong>neuralnet</strong></a> can be passed, which is internally converted into a <strong>torch</strong> model with special insights needed for interpretation. But it is also possible to pass an arbitrary net in form of a named list (see <a href="https://bips-hb.github.io/innsight/articles/detailed_overview.html#model-as-named-list">vignette</a> for details).</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The package can be installed directly from CRAN and the development version from GitHub with the following commands (successful installation of <a href="https://www.r-project.org/nosvn/pandoc/devtools.html" class="external-link"><code>devtools</code></a> is required)</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Stable version (v0.1.1)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"innsight"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Development version</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"bips-hb/innsight"</span><span class="op">)</span></span></code></pre></div>
<p>Internally, any passed model is converted to a <strong>torch</strong> model, thus the correct functionality of this package relies on a complete and correct installation of <strong>torch</strong>. For this reason, the following command must be run manually to install the missing libraries LibTorch and LibLantern:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">torch</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/torch/man/install_torch.html" class="external-link">install_torch</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p><strong>📝 Note</strong><br>
Currently this can lead to problems under Windows if the Visual Studio runtime is not pre-installed. See the issue on GitHub <a href="https://github.com/mlverse/torch/issues/246#issuecomment-695097121" class="external-link">here</a> or for more information and other problems with installing <strong>torch</strong> see the official installation <a href="https://CRAN.R-project.org/package=torch/vignettes/installation.html" class="external-link">vignette</a> of <strong>torch</strong>.</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>You have a trained neural network <code>model</code> and your model input data <code>data</code>. Now you want to interpret individual data points or the overall behavior by using the methods from the package <strong>innsight</strong>, then stick to the following pseudo code:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># --------------- Step 0: Train your model -----------------</span></span>
<span><span class="co"># 'model' has to be an instance of either torch::nn_sequential, </span></span>
<span><span class="co"># keras::keras_model_sequential, keras::keras_model or neuralnet::neuralnet</span></span>
<span><span class="va">model</span> <span class="op">=</span> <span class="va">...</span></span>
<span></span>
<span><span class="co"># -------------- Step 1: Convert your model ----------------</span></span>
<span><span class="co"># For keras and neuralnet</span></span>
<span><span class="va">converter</span> <span class="op">&lt;-</span> <span class="va"><a href="reference/Converter.html">Converter</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co"># For a torch model the argument 'input_dim' is required</span></span>
<span><span class="va">converter</span> <span class="op">&lt;-</span> <span class="va"><a href="reference/Converter.html">Converter</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">model</span>, input_dim <span class="op">=</span> <span class="va">model_input_dim</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># -------------- Step 2: Apply method ----------------------</span></span>
<span><span class="co"># Apply global method</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="va">Method</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">converter</span><span class="op">)</span> <span class="co"># no data argument is needed</span></span>
<span><span class="co"># Apply local methods</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="va">Method</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">converter</span>, <span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># -------------- Step 3: Get and plot results --------------</span></span>
<span><span class="co"># Get the results as an array</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_result.html">get_result</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="co"># Plot individual results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="co"># Plot a boxplot of all given data points in argument 'data' </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="co"># Interactive plots can also be created for both methods</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span>, as_plotly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>For a more detailed high-level introduction, see the <a href="https://bips-hb.github.io/innsight/articles/innsight.html">“Get started”</a> vignette, and for a full in-depth explanation with all the possibilities, see the <a href="https://bips-hb.github.io/innsight/articles/detailed_overview.html">“In-depth Explanation”</a> vignette.</p>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<ul>
<li>Iris dataset with <strong>torch</strong> model (numeric tabular data) <a href="https://bips-hb.github.io/innsight/articles/Example_1_iris.html">→ vignette</a>
</li>
<li>Penguin dataset with <strong>torch</strong> model and trained with <strong>luz</strong> (numeric and categorical tabular data) <a href="https://bips-hb.github.io/innsight/articles/Example_2_penguin.html">→ vignette</a>
</li>
<li>ImageNet dataset with pretrained models in <strong>keras</strong> (image data) <a href="https://bips-hb.github.io/innsight/articles/Example_3_imagenet.html">→ article</a>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="contributing-and-future-work">Contributing and Future Work<a class="anchor" aria-label="anchor" href="#contributing-and-future-work"></a>
</h2>
<p>If you would like to contribute, please open an issue or submit a pull request.</p>
<p>This package becomes even more alive and valuable if people are using it for their analyses. Therefore, don’t hesitate to write me (<a href="mailto:niklas.koenen@gmail.com" class="email">niklas.koenen@gmail.com</a>) or create a feature request if you are missing something for your analyses or have great ideas for extending this package. Currently, we are working on the following:</p>
<ul class="task-list">
<li>
<input type="checkbox" disabled checked>Extension to non-sequential models in <code>keras</code> with multiple in- and outputs, e.g. for mixed data of tabular and image data</li>
<li>
<input type="checkbox" disabled>More methods, e.g. Grad-CAM, integrated gradients, etc.</li>
<li>
<input type="checkbox" disabled>More examples and documentation (contact me if you have a non-trivial application for me)</li>
</ul>
</div>
<div class="section level2">
<h2 id="funding">Funding<a class="anchor" aria-label="anchor" href="#funding"></a>
</h2>
<p>This work is funded by the German Research Foundation (DFG) in the context of the Emmy Noether Grant 437611051.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=innsight" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/bips-hb/innsight/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/bips-hb/innsight/issues/" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing innsight</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Niklas Koenen <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-4623-8271" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/bips-hb/innsight/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/bips-hb/innsight/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://CRAN.R-project.org/package=innsight" class="external-link"><img src="https://www.r-pkg.org/badges/version/innsight" alt="CRAN status"></a></li>
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://app.codecov.io/gh/bips-hb/innsight?branch=master" class="external-link"><img src="https://codecov.io/gh/bips-hb/innsight/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Niklas Koenen.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
