<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Converted torch-based Model — ConvertedModel • innsight</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Converted torch-based Model — ConvertedModel"><meta property="og:description" content="This class stores all layers converted to torch in a module which can be
used like the original model (but torch-based). In addition, it provides
other functions that are useful for interpreting individual predictions or
explaining the entire model. This model is part of the class Converter
and is the core for all the necessary calculations in the methods provided
in this package."><meta property="og:image" content="https://bips-hb.github.io/innsight/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">innsight</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/innsight.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Example_1_iris.html">Example 1: Iris Dataset with `torch`</a>
    </li>
    <li>
      <a href="../articles/Example_2_penguin.html">Example 2: Penguin Dataset with `torch` and `luz`</a>
    </li>
    <li>
      <a href="../articles/Example_3_imagenet.html">Example 3: ImageNet with `keras`</a>
    </li>
    <li>
      <a href="../articles/detailed_overview.html">In-depth Explanation</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/bips-hb/innsight/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Converted <code>torch</code>-based Model</h1>
    <small class="dont-index">Source: <a href="https://github.com/bips-hb/innsight/blob/HEAD/R/ConvertedModel.R" class="external-link"><code>R/ConvertedModel.R</code></a></small>
    <div class="hidden name"><code>ConvertedModel.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This class stores all layers converted to <code>torch</code> in a module which can be
used like the original model (but <code>torch</code>-based). In addition, it provides
other functions that are useful for interpreting individual predictions or
explaining the entire model. This model is part of the class <code><a href="Converter.html">Converter</a></code>
and is the core for all the necessary calculations in the methods provided
in this package.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ConvertedModel</span><span class="op">(</span><span class="va">modules_list</span>, <span class="va">graph</span>, <span class="va">input_nodes</span>, <span class="va">output_nodes</span>, dtype <span class="op">=</span> <span class="st">"float"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>modules_list</dt>
<dd><p>(<code>list</code>)<br>
A list of all accepted layers created by the <code><a href="Converter.html">Converter</a></code>
class during initialization.<br></p></dd>


<dt>graph</dt>
<dd><p>(<code>list</code>)<br>
The <code>graph</code> argument gives a way to pass an input through
the model, which is especially relevant for non-sequential architectures.
It can be seen as a list of steps in which order the layers from
<code>modules_list</code> must be applied. The list contains the following elements:</p><ul><li><p><code>$current_nodes</code><br>
This list describes the current position and the number
of the respective intermediate values when passing through the model.
For example, <code>list(1,3,3)</code> means that in this step one output from the
first layer and two from the third layer (the numbers correspond to the
list indices from the <code>modules_list</code> argument) are available for
the calculation of the current layer with index <code>used_node</code>.</p></li>
<li><p><code>$used_node</code><br>
The index of the layer from the <code>modules_list</code> argument
which will be applied in this step.</p></li>
<li><p><code>$used_idx</code><br>
The indices of the outputs from <code>current_nodes</code>, which are
used as inputs of the current layer (<code>used_node</code>).</p></li>
<li><p><code>$times</code><br>
The frequency of the output value, i.e. is the output used
more than once as an input for subsequent layers?<br></p></li>
</ul></dd>


<dt>input_nodes</dt>
<dd><p>(<code>numeric</code>)<br>
A vector of layer indices describing the input layers,
i.e. they are used as the starting point for the calculations.<br></p></dd>


<dt>output_nodes</dt>
<dd><p>(<code>numeric</code>)<br>
A vector of layer indices describing the indices
of the output layers.<br></p></dd>


<dt>dtype</dt>
<dd><p>(<code>character(1)</code>)<br>
The data type for all the calculations and defined tensors. Use
either <code>'float'</code> for <code><a href="https://rdrr.io/pkg/torch/man/torch_dtype.html" class="external-link">torch::torch_float</a></code> or <code>'double'</code> for
<code><a href="https://rdrr.io/pkg/torch/man/torch_dtype.html" class="external-link">torch::torch_double</a></code>.<br></p></dd>

</dl></div>
    <div id="method-forward-">
    <h2>Method <code>forward()</code></h2>
    


<p>The forward method of the whole model, i.e. it calculates the output
\(y=f(x)\) of a given input \(x\). In doing so, all intermediate
values are stored in the individual torch modules from <code>modules_list</code>.</p><div class="section">
<h3 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h3>


<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">self</span>(x,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">channels_first =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">save_input =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">save_preactivation =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">save_output =</span> FAlSE,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">save_last_layer =</span> <span class="cn">FALSE</span>)</span></code></pre><p></p></div>
</div>

<div class="section">
<h3 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h3>


<dl><dt><code>x</code></dt>
<dd><p>The input torch tensor for this model.</p></dd>

<dt><code>channels_first</code></dt>
<dd><p>If the input tensor <code>x</code> is given in the format
'channels first' use <code>TRUE</code>. Otherwise, if the channels are last,
use <code>FALSE</code> and the input will be transformed into the format 'channels
first'. Default: <code>TRUE</code>.</p></dd>

<dt><code>save_input</code></dt>
<dd><p>Logical value whether the inputs from each layer
are to be saved or not. Default: <code>FALSE</code>.</p></dd>

<dt><code>save_preactivation</code></dt>
<dd><p>Logical value whether the preactivations
from each layer are to be saved or not. Default: <code>FALSE</code>.</p></dd>

<dt><code>save_output</code></dt>
<dd><p>Logical value whether the outputs from each layer
are to be saved or not. Default: <code>FALSE</code>.</p></dd>

<dt><code>save_last_layer</code></dt>
<dd><p>Logical value whether the inputs,
preactivations and outputs from the last layer are to be saved or not.
Default: <code>FALSE</code>.</p></dd>


</dl></div>

<div class="section">
<h3 id="return">Return<a class="anchor" aria-label="anchor" href="#return"></a></h3>


<p>Returns a list of the output values of the model with respect to the
given inputs.</p>
</div>

    </div>
    <div id="method-update-ref-">
    <h2>Method <code>update_ref()</code></h2>
    


<p>This method updates the stored intermediate values in each module from the
list <code>modules_list</code> when the reference input <code>x_ref</code> has changed.</p><div class="section">
<h3 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h3>


<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>self<span class="sc">$</span><span class="fu">update_ref</span>(x_ref,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">channels_first =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">save_input =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">save_preactivation =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">save_output =</span> FAlSE,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">save_last_layer =</span> <span class="cn">FALSE</span>)</span></code></pre><p></p></div>
</div>

<div class="section">
<h3 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h3>


<dl><dt><code>x_ref</code></dt>
<dd><p>Reference input of the model.</p></dd>

<dt><code>channels_first</code></dt>
<dd><p>If the tensor <code>x_ref</code> is given in the format
'channels first' use <code>TRUE</code>. Otherwise, if the channels are last,
use <code>FALSE</code> and the input will be transformed into the format 'channels
first'. Default: <code>TRUE</code>.</p></dd>

<dt><code>save_input</code></dt>
<dd><p>Logical value whether the inputs from each layer
are to be saved or not. Default: <code>FALSE</code>.</p></dd>

<dt><code>save_preactivation</code></dt>
<dd><p>Logical value whether the preactivations
from each layer are to be saved or not. Default: <code>FALSE</code>.</p></dd>

<dt><code>save_output</code></dt>
<dd><p>Logical value whether the outputs from each layer
are to be saved or not. Default: <code>FALSE</code>.</p></dd>

<dt><code>save_last_layer</code></dt>
<dd><p>Logical value whether the inputs,
preactivations and outputs from the last layer are to be saved or not.
Default: <code>FALSE</code>.</p></dd>


</dl></div>

<div class="section">
<h3 id="return-1">Return<a class="anchor" aria-label="anchor" href="#return-1"></a></h3>


<p>Returns a list of the output values of the model with respect to the
given reference input.</p>
</div>

    </div>
    <div id="method-set-dtype-">
    <h2>Method <code>set_dtype()</code></h2>
    


<p>This method changes the data type for all the layers in <code>modules_list</code>.
Use either <code>'float'</code> for <a href="https://rdrr.io/pkg/torch/man/torch_dtype.html" class="external-link">torch::torch_float</a> or <code>'double'</code> for
<a href="https://rdrr.io/pkg/torch/man/torch_dtype.html" class="external-link">torch::torch_double</a>.</p><div class="section">
<h3 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h3>


<p><code>self$set_dtype(dtype)</code></p>
</div>

<div class="section">
<h3 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h3>


<dl><dt><code>dtype</code></dt>
<dd><p>The data type for all the calculations and defined
tensors.</p></dd>


</dl></div>

    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Niklas Koenen.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

