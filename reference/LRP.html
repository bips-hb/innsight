<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Layer-wise Relevance Propagation (LRP) Method — LRP • innsight</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Layer-wise Relevance Propagation (LRP) Method — LRP" />
<meta property="og:description" content="This is an implementation of the Layer-wise Relevance Propagation
(LRP) algorithm introduced by Bach et al. (2015). It's a local method for
interpreting a single element of the dataset and calculates the relevance
scores for each input feature to the model output. The basic idea of this
method is to decompose the prediction score of the model with respect to
the input features, i.e.
$$f(x) = \sum_i R(x_i).$$
Because of the bias vector that absorbs some relevance, this decomposition
is generally an approximation. There exist several propagation rules to
determine the relevance scores. In this package are implemented: simple
rule (&quot;simple&quot;), epsilon rule (&quot;epsilon&quot;) and alpha-beta rule
(&quot;alpha_beta&quot;)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">innsight</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/innsight.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Custom_Model_Definition.html">Custom Model Definition</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/bips-hb/innsight/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Layer-wise Relevance Propagation (LRP) Method</h1>
    <small class="dont-index">Source: <a href='https://github.com/bips-hb/innsight/blob/master/R/LRP.R'><code>R/LRP.R</code></a></small>
    <div class="hidden name"><code>LRP.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This is an implementation of the <em>Layer-wise Relevance Propagation
(LRP)</em> algorithm introduced by Bach et al. (2015). It's a local method for
interpreting a single element of the dataset and calculates the relevance
scores for each input feature to the model output. The basic idea of this
method is to decompose the prediction score of the model with respect to
the input features, i.e.
$$f(x) = \sum_i R(x_i).$$
Because of the bias vector that absorbs some relevance, this decomposition
is generally an approximation. There exist several propagation rules to
determine the relevance scores. In this package are implemented: simple
rule ("simple"), epsilon rule ("epsilon") and alpha-beta rule
("alpha_beta").</p>
    </div>



    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>S. Bach et al. (2015) <em>On pixel-wise explanations for non-linear
classifier decisions by layer-wise relevance propagation.</em> PLoS ONE 10,
p. 1-46</p>
    <h2 class="hasAnchor" id="super-class"><a class="anchor" href="#super-class"></a>Super class</h2>

    <p><code><a href='InterpretingMethod.html'>innsight::InterpretingMethod</a></code> -&gt; <code>LRP</code></p>
    <h2 class="hasAnchor" id="public-fields"><a class="anchor" href="#public-fields"></a>Public fields</h2>

    <p><div class="r6-fields"></p><dl>
<dt><code>rule_name</code></dt><dd><p>The name of the rule with which the relevance scores
are calculated. Implemented are <code>"simple"</code>, <code>"epsilon"</code>,
<code>"alpha_beta"</code> (default: <code>"simple"</code>).</p></dd>

<dt><code>rule_param</code></dt><dd><p>The parameter of the selected rule.</p></dd>

</dl><p></div></p>
    <h2 class="hasAnchor" id="methods"><a class="anchor" href="#methods"></a>Methods</h2>

    
<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Public methods</h3>

<ul>
<li><p><a href='#method-new'><code>LRP$new()</code></a></p></li>
<li><p><a href='#method-plot'><code>LRP$plot()</code></a></p></li>
<li><p><a href='#method-boxplot'><code>LRP$boxplot()</code></a></p></li>
<li><p><a href='#method-clone'><code>LRP$clone()</code></a></p></li>
</ul>
<p><details open ><summary>Inherited methods</summary>
<ul>
<li><p><span class="pkg-link" data-pkg="innsight" data-topic="InterpretingMethod" data-id="get_result"><a href='../../innsight/html/InterpretingMethod.html#method-get_result'><code>innsight::InterpretingMethod$get_result()</code></a></span></p></li>
</ul>
</details>

<hr>
<a id="method-new"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>new()</code></h3>
<p>Create a new instance of the LRP-Method.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>LRP</span><span class='op'>$</span><span class='fu'>new</span><span class='op'>(</span>
  <span class='va'>converter</span>,
  <span class='va'>data</span>,
  channels_first <span class='op'>=</span> <span class='cn'>TRUE</span>,
  output_idx <span class='op'>=</span> <span class='cn'>NULL</span>,
  ignore_last_act <span class='op'>=</span> <span class='cn'>TRUE</span>,
  rule_name <span class='op'>=</span> <span class='st'>"simple"</span>,
  rule_param <span class='op'>=</span> <span class='cn'>NULL</span>,
  dtype <span class='op'>=</span> <span class='st'>"float"</span>
<span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>converter</code></dt><dd><p>An instance of the R6 class <code><a href='Converter.html'>Converter</a></code>.</p></dd>

<dt><code>data</code></dt><dd><p>The data for which the relevance scores are to be
calculated. It has to be an array or array-like format of size
<em>(batch_size, dim_in)</em>.</p></dd>

<dt><code>channels_first</code></dt><dd><p>The format of the given date, i.e. channels on
last dimension (<code>FALSE</code>) or after the batch dimension (<code>TRUE</code>). If the
data has no channels, use the default value <code>TRUE</code>.</p></dd>

<dt><code>output_idx</code></dt><dd><p>This vector determines for which outputs the method
will be applied. By default (<code>NULL</code>), all outputs (but limited to the
first 10) are considered.</p></dd>

<dt><code>ignore_last_act</code></dt><dd><p>Set this boolean value to include the last
activation, or not (default: <code>TRUE</code>). In some cases, the last activation
leads to a saturation problem.</p></dd>

<dt><code>rule_name</code></dt><dd><p>The name of the rule, with which the relevance scores
are calculated. Implemented are <code>"simple"</code>, <code>"epsilon"</code>,
<code>"alpha_beta"</code> (default: <code>"simple"</code>).</p></dd>

<dt><code>rule_param</code></dt><dd><p>The parameter of the selected rule. Note: Only the
rules <code>"epsilon"</code> and <code>"alpha_beta"</code> take use of the
parameter. Use the default value <code>NULL</code> for the default parameters
("epsilon" : \(0.01\), "alpha_beta" : \(0.5\)).</p></dd>

<dt><code>dtype</code></dt><dd><p>The data type for the calculations. Use
either <code>'float'</code> for <a href='https://torch.mlverse.org/docs/reference/torch_dtype.html'>torch::torch_float</a> or <code>'double'</code> for
<a href='https://torch.mlverse.org/docs/reference/torch_dtype.html'>torch::torch_double</a>.</p></dd>

</dl><p></div></p>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Returns</h4>
<p>A new instance of the R6 class <code>'LRP'</code>.</p>
<p><hr>
<a id="method-plot"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code><a href='https://rdrr.io/r/graphics/plot.default.html'>plot()</a></code></h3>
<p>This method visualizes the result of the selected method in a
<a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot2::ggplot</a>. You can use the argument <code>data_idx</code> to select
the data points in the given data for the plot. In addition, the
individual output nodes for the plot can be selected with the argument
<code>output_idx</code>. The different results for the selected data points and
outputs are visualized using the method <a href='https://ggplot2.tidyverse.org/reference/facet_grid.html'>ggplot2::facet_grid</a>.
You can also use the <code>as_plotly</code> argument to generate an interactive
plot based on the plot function <a href='https://rdrr.io/pkg/plotly/man/plot_ly.html'>plotly::plot_ly</a>.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>LRP</span><span class='op'>$</span><span class='fu'>plot</span><span class='op'>(</span>
  data_idx <span class='op'>=</span> <span class='fl'>1</span>,
  output_idx <span class='op'>=</span> <span class='cn'>NULL</span>,
  aggr_channels <span class='op'>=</span> <span class='st'>"sum"</span>,
  as_plotly <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>data_idx</code></dt><dd><p>An integer vector containing the numbers of the data
points whose result is to be plotted, e.g. <code>c(1,3)</code> for the first
and third data point in the given data. Default: <code>c(1)</code>.</p></dd>

<dt><code>output_idx</code></dt><dd><p>An integer vector containing the numbers of the
output indices whose result is to be plotted, e.g. <code>c(1,4)</code> for the
first and fourth model output. But this vector must be included in the
vector <code>output_idx</code> from the initialization, otherwise, no results were
calculated for this output node and can not be plotted. By default
(<code>NULL</code>), the smallest index of all calculated output nodes is used.</p></dd>

<dt><code>aggr_channels</code></dt><dd><p>Pass one of <code>'norm'</code>, <code>'sum'</code>, <code>'mean'</code> or a
custom function to aggregate the channels, e.g. the maximum
(base::max) or minimum (base::min) over the channels or only
individual channels with <code>function(x) x[1]</code>. By default (<code>'sum'</code>),
the sum of all channels is used.<br />
<strong>Note:</strong> This argument is used only for 2D and 3D inputs.</p></dd>

<dt><code>as_plotly</code></dt><dd><p>This boolean value (default: <code>FALSE</code>) can be used to
create an interactive plot based on the library <code>plotly</code>. This function
takes use of <a href='https://rdrr.io/pkg/plotly/man/ggplotly.html'>plotly::ggplotly</a>, hence make sure that the suggested
package <code>plotly</code> is installed in your R session.<br />
<strong>Advanced:</strong> You can first
output the results as a ggplot (<code>as_plotly = FALSE</code>) and then make
custom changes to the plot, e.g. other theme or other fill color. Then
you can manually call the function <code>ggplotly</code> to get an interactive
plotly plot.</p></dd>

</dl><p></div></p>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Returns</h4>
<p>Returns either a <a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot2::ggplot</a> (<code>as_plotly = FALSE</code>) or a
<a href='https://rdrr.io/pkg/plotly/man/plot_ly.html'>plotly::plot_ly</a> (<code>as_plotly = TRUE</code>) with the plotted results.</p>
<p><hr>
<a id="method-boxplot"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code><a href='https://rdrr.io/r/graphics/boxplot.html'>boxplot()</a></code></h3>
<p>This function visualizes the results of this method in a boxplot, where
the type of visualization depends on the input dimension of the data.
By default a <a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot2::ggplot</a> is returned, but with the argument
<code>as_plotly</code> an interactive <a href='https://rdrr.io/pkg/plotly/man/plot_ly.html'>plotly::plot_ly</a> plot can be created,
which however requires a successful installation of the package
<code>plotly</code>.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>LRP</span><span class='op'>$</span><span class='fu'>boxplot</span><span class='op'>(</span>
  output_idx <span class='op'>=</span> <span class='cn'>NULL</span>,
  data_idx <span class='op'>=</span> <span class='st'>"all"</span>,
  ref_data_idx <span class='op'>=</span> <span class='cn'>NULL</span>,
  aggr_channels <span class='op'>=</span> <span class='st'>"norm"</span>,
  preprocess_FUN <span class='op'>=</span> <span class='va'>abs</span>,
  as_plotly <span class='op'>=</span> <span class='cn'>FALSE</span>,
  individual_data_idx <span class='op'>=</span> <span class='cn'>NULL</span>,
  individual_max <span class='op'>=</span> <span class='fl'>20</span>
<span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>output_idx</code></dt><dd><p>An integer vector containing the numbers of the
output indices whose result is to be plotted, e.g. <code>c(1,4)</code> for the
first and fourth model output. But this vector must be included in the
vector <code>output_idx</code> from the initialization, otherwise, no results were
calculated for this output node and can not be plotted. By default
(<code>NULL</code>), the smallest index of all calculated output nodes is used.</p></dd>

<dt><code>data_idx</code></dt><dd><p>By default ("all"), all available data is used to
calculate the boxplot information. However, this parameter can be used
to select a subset of them by passing the indices. E.g. with
<code>data_idx = c(1:10, 25, 26)</code> only the first <code>10</code> data points and
the 25th and 26th are used to calculate the boxplots.</p></dd>

<dt><code>ref_data_idx</code></dt><dd><p>This integer number determines the index for the
reference data point. In addition to the boxplots, it is displayed in
red color and is used to compare an individual result with the summary
statistics provided by the boxplot. With the default value (<code>NULL</code>)
no individual data point is plotted. This index can be chosen with
respect to all available data, even if only a subset is selected with
argument <code>data_idx</code>.<br />
<strong>Note:</strong> Because of the complexity of 3D inputs, this argument is used
only for 1D and 2D inputs and disregarded for 3D inputs.</p></dd>

<dt><code>aggr_channels</code></dt><dd><p>Pass one of <code>'norm'</code>, <code>'sum'</code>, <code>'mean'</code> or a
custom function to aggregate the channels, e.g. the maximum
(base::max) or minimum (base::min) over the channels or only
individual channels with <code>function(x) x[1]</code>. By default (<code>'norm'</code>),
the Euclidean norm of all channels is used.<br />
<strong>Note:</strong> This argument is used only for 2D and 3D inputs.</p></dd>

<dt><code>preprocess_FUN</code></dt><dd><p>This function is applied to the method's result
before calculating the boxplots. Since positive and negative values
often cancel each other out, the absolute value (<code>abs</code>) is used by
default. But you can also use the raw data (<code>identity</code>) to see the
results' orientation, the squared data (<code>function(x) x^2</code>) to weight
the outliers higher or any other function.</p></dd>

<dt><code>as_plotly</code></dt><dd><p>This boolean value (default: <code>FALSE</code>) can be used to
create an interactive plot based on the library <code>plotly</code> instead of
<code>ggplot2</code>. Make sure that the suggested package <code>plotly</code> is installed
in your R session.</p></dd>

<dt><code>individual_data_idx</code></dt><dd><p>Only relevant for a <code>plotly</code> plot with input
dimension <code>1</code> or <code>2</code>! This integer vector of data indices determines
the available data points in a dropdown menu, which are drawn in
individually analogous to <code>ref_data_idx</code> only for more data points.
With the default value <code>NULL</code> the first <code>individual_max</code> data points
are used.<br />
<strong>Note:</strong> If <code>ref_data_idx</code> is specified, this data point will be
added to those from <code>individual_data_idx</code> in the dropdown menu.</p></dd>

<dt><code>individual_max</code></dt><dd><p>Only relevant for a <code>plotly</code> plot with input
dimension <code>1</code> or <code>2</code>! This integer determines the maximum number of
individual data points in the dropdown menu without counting
<code>ref_data_idx</code>. This means that if <code>individual_data_idx</code> has more
than <code>individual_max</code> indices, only the first <code>individual_max</code> will
be used. A too high number can significantly increase the runtime.</p></dd>

</dl><p></div></p>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Returns</h4>
<p>Returns either a <a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot2::ggplot</a> (<code>as_plotly = FALSE</code>) or a
<a href='https://rdrr.io/pkg/plotly/man/plot_ly.html'>plotly::plot_ly</a> (<code>as_plotly = TRUE</code>) with the boxplots.</p>
<p><hr>
<a id="method-clone"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>clone()</code></h3>
<p>The objects of this class are cloneable with this method.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>LRP</span><span class='op'>$</span><span class='fu'>clone</span><span class='op'>(</span>deep <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>deep</code></dt><dd><p>Whether to make a deep clone.</p></dd>

</dl><p></div></p>



    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'> <span class='co'>#----------------------- Example 1: Torch ----------------------------------</span></span>
<span class='r-in'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://torch.mlverse.org/docs'>torch</a></span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Create nn_sequential model and data</span></span>
<span class='r-in'><span class='va'>model</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://torch.mlverse.org/docs/reference/nn_sequential.html'>nn_sequential</a></span><span class='op'>(</span></span>
<span class='r-in'>  <span class='fu'><a href='https://torch.mlverse.org/docs/reference/nn_linear.html'>nn_linear</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>12</span><span class='op'>)</span>,</span>
<span class='r-in'>  <span class='fu'><a href='https://torch.mlverse.org/docs/reference/nn_relu.html'>nn_relu</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span class='r-in'>  <span class='fu'><a href='https://torch.mlverse.org/docs/reference/nn_linear.html'>nn_linear</a></span><span class='op'>(</span><span class='fl'>12</span>, <span class='fl'>2</span><span class='op'>)</span>,</span>
<span class='r-in'>  <span class='fu'><a href='https://torch.mlverse.org/docs/reference/nn_softmax.html'>nn_softmax</a></span><span class='op'>(</span>dim <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-in'><span class='op'>)</span></span>
<span class='r-in'><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://torch.mlverse.org/docs/reference/torch_randn.html'>torch_randn</a></span><span class='op'>(</span><span class='fl'>25</span>, <span class='fl'>5</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Create Converter</span></span>
<span class='r-in'><span class='va'>converter</span> <span class='op'>&lt;-</span> <span class='va'><a href='Converter.html'>Converter</a></span><span class='op'>$</span><span class='fu'>new</span><span class='op'>(</span><span class='va'>model</span>, input_dim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Apply method LRP with simple rule (default)</span></span>
<span class='r-in'><span class='va'>lrp</span> <span class='op'>&lt;-</span> <span class='va'>LRP</span><span class='op'>$</span><span class='fu'>new</span><span class='op'>(</span><span class='va'>converter</span>, <span class='va'>data</span><span class='op'>)</span></span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Backward pass 'LRP':</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Print the result as an array for data point one and two</span></span>
<span class='r-in'><span class='va'>lrp</span><span class='op'>$</span><span class='fu'>get_result</span><span class='op'>(</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span>,,<span class='op'>]</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> , , Y1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>             X1           X2          X3         X4          X5</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1  0.009376573 0.0007551969 -0.01986527  0.1105140 -0.01554380</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2 -0.034303110 0.0632186756 -0.01030651 -0.1749057  0.07149401</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> , , Y2</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>            X1           X2           X3        X4          X5</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1 -0.03600737 -0.004128753 -0.015916487 0.1217999 -0.03905627</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2  0.05323519 -0.048201058  0.002810451 0.2067945 -0.09148183</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Plot the result for both classes</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>lrp</span>, output_idx <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-plt img'><img src='LRP-1.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Plot the boxplot of all datapoints without preprocess function</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/boxplot.html'>boxplot</a></span><span class='op'>(</span><span class='va'>lrp</span>, output_idx <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span>, preprocess_FUN <span class='op'>=</span> <span class='va'>identity</span><span class='op'>)</span></span>
<span class='r-plt img'><img src='LRP-2.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># ------------------------- Example 2: Neuralnet ---------------------------</span></span>
<span class='r-in'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/bips-hb/neuralnet'>neuralnet</a></span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>nn</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/neuralnet/man/neuralnet.html'>neuralnet</a></span><span class='op'>(</span><span class='va'>Species</span> <span class='op'>~</span> <span class='va'>.</span>,</span>
<span class='r-in'>  <span class='va'>iris</span>,</span>
<span class='r-in'>  linear.output <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span class='r-in'>  hidden <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>8</span><span class='op'>)</span>, act.fct <span class='op'>=</span> <span class='st'>"tanh"</span>, rep <span class='op'>=</span> <span class='fl'>1</span>, threshold <span class='op'>=</span> <span class='fl'>0.5</span></span>
<span class='r-in'><span class='op'>)</span></span>
<span class='r-in'><span class='co'># create an converter for this model</span></span>
<span class='r-in'><span class='va'>converter</span> <span class='op'>&lt;-</span> <span class='va'><a href='Converter.html'>Converter</a></span><span class='op'>$</span><span class='fu'>new</span><span class='op'>(</span><span class='va'>nn</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># create new instance of 'LRP'</span></span>
<span class='r-in'><span class='va'>lrp</span> <span class='op'>&lt;-</span> <span class='va'>LRP</span><span class='op'>$</span><span class='fu'>new</span><span class='op'>(</span><span class='va'>converter</span>, <span class='va'>iris</span><span class='op'>[</span>, <span class='op'>-</span><span class='fl'>5</span><span class='op'>]</span>, rule_name <span class='op'>=</span> <span class='st'>"simple"</span><span class='op'>)</span></span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Backward pass 'LRP':</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |=======================                                               |  33%  |                                                                              |===============================================                       |  67%  |                                                                              |======================================================================| 100%</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># get the result as an array for data point one and two</span></span>
<span class='r-in'><span class='va'>lrp</span><span class='op'>$</span><span class='fu'>get_result</span><span class='op'>(</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span>,,<span class='op'>]</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> , , setosa</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   Sepal.Length Sepal.Width Petal.Length Petal.Width</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1     3.928332    1.053082   -0.6294739   0.6488832</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2     3.001994    1.731096   -0.8032066   0.6173689</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> , , versicolor</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   Sepal.Length Sepal.Width Petal.Length Petal.Width</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1     5.665174   -6.472754     2.769754    1.075689</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2     3.043177   -4.309211     2.860033    1.060005</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> , , virginica</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   Sepal.Length Sepal.Width Petal.Length Petal.Width</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1     2.111376   -3.146020     1.266815   0.8472772</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2     2.385662   -3.241929     1.276490   0.9121323</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># get the result as a torch tensor for data point one and two</span></span>
<span class='r-in'><span class='va'>lrp</span><span class='op'>$</span><span class='fu'>get_result</span><span class='op'>(</span>type <span class='op'>=</span> <span class='st'>"torch.tensor"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> torch_tensor</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> (1,.,.) = </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   3.9283  5.6652  2.1114</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   1.0531 -6.4728 -3.1460</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  -0.6295  2.7698  1.2668</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   0.6489  1.0757  0.8473</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> (2,.,.) = </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   3.0020  3.0432  2.3857</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   1.7311 -4.3092 -3.2419</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  -0.8032  2.8600  1.2765</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   0.6174  1.0600  0.9121</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [ CPUFloatType{2,4,3} ]</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># use the alpha-beta rule with alpha = 2</span></span>
<span class='r-in'><span class='va'>lrp</span> <span class='op'>&lt;-</span> <span class='va'>LRP</span><span class='op'>$</span><span class='fu'>new</span><span class='op'>(</span><span class='va'>converter</span>, <span class='va'>iris</span><span class='op'>[</span>, <span class='op'>-</span><span class='fl'>5</span><span class='op'>]</span>,</span>
<span class='r-in'>  rule_name <span class='op'>=</span> <span class='st'>"alpha_beta"</span>,</span>
<span class='r-in'>  rule_param <span class='op'>=</span> <span class='fl'>2</span></span>
<span class='r-in'><span class='op'>)</span></span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Backward pass 'LRP':</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |=======================                                               |  33%  |                                                                              |===============================================                       |  67%  |                                                                              |======================================================================| 100%</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># include the last activation into the calculation</span></span>
<span class='r-in'><span class='va'>lrp</span> <span class='op'>&lt;-</span> <span class='va'>LRP</span><span class='op'>$</span><span class='fu'>new</span><span class='op'>(</span><span class='va'>converter</span>, <span class='va'>iris</span><span class='op'>[</span>, <span class='op'>-</span><span class='fl'>5</span><span class='op'>]</span>,</span>
<span class='r-in'>  rule_name <span class='op'>=</span> <span class='st'>"alpha_beta"</span>,</span>
<span class='r-in'>  rule_param <span class='op'>=</span> <span class='fl'>2</span>,</span>
<span class='r-in'>  ignore_last_act <span class='op'>=</span> <span class='cn'>FALSE</span></span>
<span class='r-in'><span class='op'>)</span></span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Backward pass 'LRP':</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |=======================                                               |  33%  |                                                                              |===============================================                       |  67%  |                                                                              |======================================================================| 100%</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Plot the result for all classes</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>lrp</span>, output_idx <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span></span>
<span class='r-plt img'><img src='LRP-3.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Plot the Boxplot for the first class</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/boxplot.html'>boxplot</a></span><span class='op'>(</span><span class='va'>lrp</span><span class='op'>)</span></span>
<span class='r-plt img'><img src='LRP-4.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># You can also create an interactive plot with plotly.</span></span>
<span class='r-in'><span class='co'># This is a suggested package, so make sure that it is installed</span></span>
<span class='r-in'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://plotly-r.com'>plotly</a></span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Result as boxplots</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/boxplot.html'>boxplot</a></span><span class='op'>(</span><span class='va'>lrp</span>, as_plotly <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Result of the second data point</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>lrp</span>, data_idx <span class='op'>=</span> <span class='fl'>2</span>, as_plotly <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># ------------------------- Example 3: Keras -------------------------------</span></span>
<span class='r-in'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://keras.rstudio.com'>keras</a></span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://keras.rstudio.com/reference/is_keras_available.html'>is_keras_available</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'>  <span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>10</span> <span class='op'>*</span> <span class='fl'>60</span> <span class='op'>*</span> <span class='fl'>3</span><span class='op'>)</span>, dim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>60</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'>  <span class='va'>model</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://keras.rstudio.com/reference/keras_model_sequential.html'>keras_model_sequential</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span class='r-in'>  <span class='va'>model</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span class='r-in'>    <span class='fu'><a href='https://keras.rstudio.com/reference/layer_conv_1d.html'>layer_conv_1d</a></span><span class='op'>(</span></span>
<span class='r-in'>      input_shape <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>60</span>, <span class='fl'>3</span><span class='op'>)</span>, kernel_size <span class='op'>=</span> <span class='fl'>8</span>, filters <span class='op'>=</span> <span class='fl'>8</span>,</span>
<span class='r-in'>      activation <span class='op'>=</span> <span class='st'>"softplus"</span>, padding <span class='op'>=</span> <span class='st'>"valid"</span></span>
<span class='r-in'>    <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span class='r-in'>    <span class='fu'><a href='https://keras.rstudio.com/reference/layer_conv_1d.html'>layer_conv_1d</a></span><span class='op'>(</span></span>
<span class='r-in'>      kernel_size <span class='op'>=</span> <span class='fl'>8</span>, filters <span class='op'>=</span> <span class='fl'>4</span>, activation <span class='op'>=</span> <span class='st'>"tanh"</span>,</span>
<span class='r-in'>      padding <span class='op'>=</span> <span class='st'>"same"</span></span>
<span class='r-in'>    <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span class='r-in'>    <span class='fu'><a href='https://keras.rstudio.com/reference/layer_conv_1d.html'>layer_conv_1d</a></span><span class='op'>(</span></span>
<span class='r-in'>      kernel_size <span class='op'>=</span> <span class='fl'>4</span>, filters <span class='op'>=</span> <span class='fl'>2</span>, activation <span class='op'>=</span> <span class='st'>"relu"</span>,</span>
<span class='r-in'>      padding <span class='op'>=</span> <span class='st'>"valid"</span></span>
<span class='r-in'>    <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span class='r-in'>    <span class='fu'><a href='https://keras.rstudio.com/reference/layer_flatten.html'>layer_flatten</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span class='r-in'>    <span class='fu'><a href='https://keras.rstudio.com/reference/layer_dense.html'>layer_dense</a></span><span class='op'>(</span>units <span class='op'>=</span> <span class='fl'>64</span>, activation <span class='op'>=</span> <span class='st'>"relu"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span class='r-in'>    <span class='fu'><a href='https://keras.rstudio.com/reference/layer_dense.html'>layer_dense</a></span><span class='op'>(</span>units <span class='op'>=</span> <span class='fl'>16</span>, activation <span class='op'>=</span> <span class='st'>"relu"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span class='r-in'>    <span class='fu'><a href='https://keras.rstudio.com/reference/layer_dense.html'>layer_dense</a></span><span class='op'>(</span>units <span class='op'>=</span> <span class='fl'>3</span>, activation <span class='op'>=</span> <span class='st'>"softmax"</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'>  <span class='co'># Convert the model</span></span>
<span class='r-in'>  <span class='va'>converter</span> <span class='op'>&lt;-</span> <span class='va'><a href='Converter.html'>Converter</a></span><span class='op'>$</span><span class='fu'>new</span><span class='op'>(</span><span class='va'>model</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'>  <span class='co'># Apply the LRP method with the epsilon rule and eps = 0.1</span></span>
<span class='r-in'>  <span class='va'>lrp_eps</span> <span class='op'>&lt;-</span> <span class='va'>LRP</span><span class='op'>$</span><span class='fu'>new</span><span class='op'>(</span><span class='va'>converter</span>, <span class='va'>data</span>,</span>
<span class='r-in'>    channels_first <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span class='r-in'>    rule_name <span class='op'>=</span> <span class='st'>"epsilon"</span>,</span>
<span class='r-in'>    rule_param <span class='op'>=</span> <span class='fl'>0.1</span></span>
<span class='r-in'>  <span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'>  <span class='co'># Plot the result for the first datapoint and all classes</span></span>
<span class='r-in'>  <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>lrp_eps</span>, output_idx <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'>  <span class='co'># Plot the result as boxplots for first two classes</span></span>
<span class='r-in'>  <span class='fu'><a href='https://rdrr.io/r/graphics/boxplot.html'>boxplot</a></span><span class='op'>(</span><span class='va'>lrp_eps</span>, output_idx <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'>  <span class='co'># You can also create an interactive plot with plotly.</span></span>
<span class='r-in'>  <span class='co'># This is a suggested package, so make sure that it is installed</span></span>
<span class='r-in'>  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://plotly-r.com'>plotly</a></span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'>  <span class='co'># Result as boxplots</span></span>
<span class='r-in'>  <span class='fu'><a href='https://rdrr.io/r/graphics/boxplot.html'>boxplot</a></span><span class='op'>(</span><span class='va'>lrp_eps</span>, as_plotly <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'>  <span class='co'># Result of the second data point</span></span>
<span class='r-in'>  <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>lrp_eps</span>, data_idx <span class='op'>=</span> <span class='fl'>2</span>, as_plotly <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span class='r-in'><span class='op'>}</span></span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Backward pass 'LRP':</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |==========                                                            |  14%  |                                                                              |====================                                                  |  29%  |                                                                              |==============================                                        |  43%  |                                                                              |========================================                              |  57%  |                                                                              |==================================================                    |  71%  |                                                                              |============================================================          |  86%  |                                                                              |======================================================================| 100%</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># ------------------------- Advanced: Plotly -------------------------------</span></span>
<span class='r-in'><span class='co'># If you want to create an interactive plot of your results with custom</span></span>
<span class='r-in'><span class='co'># changes, you can take use of the method plotly::ggplotly</span></span>
<span class='r-in'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span></span>
<span class='r-in'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://plotly-r.com'>plotly</a></span><span class='op'>)</span></span>
<span class='r-in'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/bips-hb/neuralnet'>neuralnet</a></span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>nn</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/neuralnet/man/neuralnet.html'>neuralnet</a></span><span class='op'>(</span><span class='va'>Species</span> <span class='op'>~</span> <span class='va'>.</span>,</span>
<span class='r-in'>  <span class='va'>iris</span>,</span>
<span class='r-in'>  linear.output <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span class='r-in'>  hidden <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>8</span><span class='op'>)</span>, act.fct <span class='op'>=</span> <span class='st'>"tanh"</span>, rep <span class='op'>=</span> <span class='fl'>1</span>, threshold <span class='op'>=</span> <span class='fl'>0.5</span></span>
<span class='r-in'><span class='op'>)</span></span>
<span class='r-in'><span class='co'># create an converter for this model</span></span>
<span class='r-in'><span class='va'>converter</span> <span class='op'>&lt;-</span> <span class='va'><a href='Converter.html'>Converter</a></span><span class='op'>$</span><span class='fu'>new</span><span class='op'>(</span><span class='va'>nn</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># create new instance of 'LRP'</span></span>
<span class='r-in'><span class='va'>lrp</span> <span class='op'>&lt;-</span> <span class='va'>LRP</span><span class='op'>$</span><span class='fu'>new</span><span class='op'>(</span><span class='va'>converter</span>, <span class='va'>iris</span><span class='op'>[</span>, <span class='op'>-</span><span class='fl'>5</span><span class='op'>]</span><span class='op'>)</span></span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Backward pass 'LRP':</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |=======================                                               |  33%  |                                                                              |===============================================                       |  67%  |                                                                              |======================================================================| 100%</span>
<span class='r-in'></span>
<span class='r-in'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://plotly-r.com'>plotly</a></span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Get the ggplot and add your changes</span></span>
<span class='r-in'><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>lrp</span>, output_idx <span class='op'>=</span> <span class='fl'>1</span>, data_idx <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span class='r-in'>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span class='r-in'>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_gradient.html'>scale_fill_gradient2</a></span><span class='op'>(</span>low <span class='op'>=</span> <span class='st'>"green"</span>, mid <span class='op'>=</span> <span class='st'>"black"</span>, high <span class='op'>=</span> <span class='st'>"blue"</span><span class='op'>)</span></span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Scale for 'fill' is already present. Adding another scale for 'fill', which</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> will replace the existing scale.</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Now apply the method plotly::ggplotly with argument tooltip = "text"</span></span>
<span class='r-in'><span class='fu'>plotly</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/plotly/man/ggplotly.html'>ggplotly</a></span><span class='op'>(</span><span class='va'>p</span>, tooltip <span class='op'>=</span> <span class='st'>"text"</span><span class='op'>)</span></span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Niklas Koenen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


